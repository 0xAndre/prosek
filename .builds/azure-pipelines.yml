trigger:
  branches:
    include:
    - main
  paths:
    include:
    - 'src'

pool:
  vmImage: windows-latest

name: $(major).$(minor).$(patch).$(Rev:r)

jobs:
- job: build
  steps:
    - task: DotNetCoreCLI@2
      inputs:
        command: 'build'
        projects: 'src/prosek.sln'
        arguments: '-c Release'
      displayName: build

    - task: ArchiveFiles@2
      inputs:
        rootFolderOrFile: 'src/_bin/Release/net7.0-windows'
        includeRootFolder: false
        archiveType: 'zip'
        archiveFile: '$(Build.ArtifactStagingDirectory)/prosek.zip'
        replaceExistingArchive: true

    - task: PublishBuildArtifacts@1
      inputs:
        PathtoPublish: '$(Build.ArtifactStagingDirectory)'
        ArtifactName: 'drop'
        publishLocation: 'Container'
      displayName: publish artifacts